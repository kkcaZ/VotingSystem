@page "/admin"
@inherits AuthenticatedPage

<div class="page-container">
    <h1 class="text-center page-title">Admin Panel</h1>
    <div class="admin-panel">
        <h2 style="display: flex; align-items: center;">Your Elections <i class="fas fa-sync-alt btn" style="margin-left: auto;"></i></h2>
        <div class="election-list">
            @if (_administeredElections == null || _administeredElections.Count == 0)
            {
                <p>
                    You do not currently administer any elections...
                </p>
            }
            else
            {
                <table>
                    <tr>
                        <th>Name</th>
                        <th>Nation</th>
                        <th>Type</th>
                        <th>Start Time</th>
                        <th>End Time</th>
                        <th><!-- Edit btn --></th>
                        
                    </tr>
                    @foreach (var election in _administeredElections)
                    {
                        <tr>
                            <td>@election.Name</td>
                            <td>@election.Nation</td>
                            <td>@election.Type</td>
                            <td>@election.StartTime</td>
                            <td>@election.EndTime</td>
                            <td>
                                <i class="fas fa-edit"></i>
                                <i class="fas fa-trash" @onclick="@(() => DeleteElection(@election.Id))"></i>
                            </td>
                        </tr>
                    }
                </table>
            }
        </div>
        <a class="btn btn-accent">Create an Election</a>
    </div>
    
    <div class="admin-panel">
        <h2>Create an Election</h2>
        <EditForm Model="_election">
            <label for="electionName">
                Title
                <input name="electionName" id="electionName" type="text" @bind="_election.Name"/>
            </label>
            <label for="nation">
                Nation
                <select name="nation" id="nation" @bind="_election.Nation">
                    <option selected disabled>Select Nation</option>
                    @foreach (string nation in _nations)
                    {
                        <option>@nation</option>
                    }
                </select>
            </label>
            <label for="type">
                Type
                <select name="type" id="type" @bind="_election.Type">
                    <option selected disabled></option>
                    @foreach (string type in _types)
                    {
                        <option value="@type.Replace(" ", "")">@type</option>
                    }
                </select>
            </label>
            <div class="column-container">
                <label style="padding-right: 1rem;">
                    Voting Start Time
                    <input name="endTime" type="datetime-local" @bind="_election.StartTime"/>
                </label>
                <label>
                    Voting End Time
                    <input name="endTime" type="datetime-local" @bind="_election.EndTime"/>
                </label>
            </div>
            <div class="column-container">
                <label>
                    Add Candidate
                    <div class="column-container align-center">
                        <input name="candidate" type="email" placeholder="Candidate's Email" @bind="_candidateEmail" style="margin-right: 1rem;"/>
                        <i class="btn fas fa-plus fa-black" @onclick="AddCandidateButton"></i>
                    </div>
                </label>
                <div>
                    Candidates
                    @if (_candidates.Count == 0)
                    {
                        <p style="padding-top: 1rem;">No candidates added...</p>
                    }
                    else
                    {
                        <ul style="padding-top: 1rem;">
                            @foreach (var user in _candidates)
                            {
                                <li>@user</li>
                            }
                        </ul>
                    }
                </div>
            </div>
            <button id="nextBtn" class="btn btn-accent" @onclick="CreateElection">Create Election</button>
        </EditForm>
    </div>
</div>